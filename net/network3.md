# 网络实例模型
- OSI模型
模型本身有意义但是协议没人用
- TCP/IP模型
模型本身没多大用但是协议被广泛使用

## OSI模型
全称：ISO的开放系统互联参考模型
OSI有7层
### 基本原则
- 应该在需要一个不同抽象体的地方创建一层
- 每一层都应该执行一个明确定义的功能
- 每一层功能的选择应该向定义国际标准化协议的目标看齐
- 层与层边界的选择应该使跨越接口的信息流最小
- 层数应该足够多，保证不同的功能不会被混杂在同一层中，但同时层数又不可以太多，以免体系结构变得过于庞大

**OSI参考模型并不是一个网络体系结构**，因为它没有定义每一层的服务和所用的协议，它只是指明了每一层该做什么

#### 物理层
- 用什么电子信号来表示1/0
- 一个比特持续多少纳秒
- 传输是否可以在两个方向上同时进行
- 初始连接如何建立
- 双方结束后如何撤销连接
- 网络连接器有多少针以及每一根针的用途是什么

#### 数据链路层
**主要任务：将一个原始的传输设施变成一条没有漏检传输错误的线路**
数据链路层的做法是：将真实的错误掩盖起来，使网络层看不到
1 发送方将数据拆分成数据帧，然后顺序发送数据帧。若服务可靠，则接收方确认正确收到的每一帧并发回一个确认帧
2 流量调节机制，防止过多数据淹没接收方
3 广播式网络还要控制对共享信道的访问，数据链路层的一个特殊子层（介质访问控制子层）专门处理这个问题

#### 网络层

**网络层的主要任务是控制子网的运行**
1 路由算法，将包从发送方发到接收方
2 处理拥塞（与高层协议结合起来处理）
3 服务质量（延迟 传输时间 抖动）
4 解决网络异构的问题，允许异构网络互联（寻址方案不同， 协议不同）
**广播式网络中路由问题简单，所以网络层可以比较小或者没有**

#### 传输层
**接受上一层的数据，必要的时候把他们分成较小的单元，然后把这些单元传递给网络层**
要求：高效 上下隔离 对上层透明
传输层还决定了向（会话层）实际的最终网络用户提供哪种服务
- 完全无错的点到点信道同时按照原始顺序传输报文或字节数据
- 传输报文但不保证顺序
- 报文广播给多个节点
**服务的类型是建立连接时就确定的**
**完全无错的信道是不存在的**
传输层是端到端的层，只知道要把数据从哪带到哪
而其下的层都是涉及某一台机器与它的直接邻居

#### 会话层
允许不同机器上的用户建立会话
回话包括：
- 对话控制：记录该由谁来传递数据
- 令牌管理：禁止双方同时执行同一个关键操作
- 同步工作：长传输过程中设置断点，以便在崩溃之后还能继续恢复

#### 表示层
表示层以下的各层都关注如何传递数据位
而表示层关注传递数据的语法和语义
//大端法小端法之类的

#### 应用层
包含用户通常需要的各种各样的协议
HTTP（超文本传输协议）
HTTP是WWW（万维网）的基础
浏览器需要web页面时，通过http将所要界面的名字发给服务器，然后服务器将页面发送回浏览器
其他协议可以用于文件传输，电子邮件，网络新闻等


## TCP/IP模型
ARPANET -》internet

### 链路层
由于美国国防部希望互联网中贵重的主机或硬件在受到攻击时仍能正常工作，因此选择了数据包交换网络。该模型选择了一个可运行在不同网络上的无连接网络层为基础。
该层描述了链路必须完成什么功能才能满足无连接的互联网络层的需求（such as 串行线和经典以太网链路）
**这只是主机与传输线路之间的一个接口 并非真正意义的一个层**

### 互联网层
大致对应于OSI中的网络层
任务：允许主机将数据包注入任何网络，并且这些数据包独立地到达接收方，甚至数据包的到达顺序与它们被发送的顺序不同。
如果要按序排布，那么排序由高层来完成
互联网层定义了数据包格式和协议，称为因特网协议（IP）除此之外还有因特网控制报文协议（ICMP）
要解决 **1 路由 2 拥塞**
虽然ip协议不能解决拥塞问题

### 传输层
任务：允许源主机与目标主机上的对等实体进行对话
两个协议
#### TCP
可靠的 面向连接的，允许从一台机器发出的字节流正确无误地交付给互联网上的另一台机器。
发出端：把输入的字节流分割成离散的报文传给互联网层
接收端：把接收到的报文重新装配到输出流中
TCP还负责处理流量控制，防止淹没
#### UDP
不可靠无连接协议
适用于不想要TCP的有序性和流量控制功能的应用程序
UDP广泛应用于一次性基于客户机-服务器类型的‘请求-查询’模型，以及及时交付比精确交付更重要的应用（语音视频）
#### 应用层
**TCP/IP没有会话层和表示层-因为对于大多数应用这两层没多大用**
包含高层协议：
- TELNET 虚拟终端
- FTP 文件传输协议
- SMTP 电子邮件协议
- DNS 域名系统
- HTTP
- RTP 传送语音或电影

## 本书的模型
OSI体现在模型
TCP/IP体现在协议本身
本书使用混合模型（就是TCP/IP嘛）

### 物理层
在不同的介质上如何以各种信号传递bit
### 链路层
如何在两台直连的计算机之间发送有限长度的信息
同时具有指定级别的可靠性
### 网络层
主要处理如何把多条链路结合到网络中
如何把网络和网络结合成互联网
路由算法
IP
### 传输层
增强了网络层的传递保证，更可靠
提供了数据交互的抽象
TCP/UDP
### 应用层
应用程序和部分重要支撑程序

## OSI与TCP/IP的比较
OSI封装的更好，隐蔽性更好，技术变化时OSI中的协议更容易被新协议替换
- OSI网络层支持无连接和面向连接的通信
传输层却只支持面向连接的通信
- TCP/IP网络层只支持无连接的模式
而传输层却支持两种模式

TCP/IP给了用户更多的选择
对‘请求/应答‘协议很重要

## OSI失败的原因
### 糟糕的时机
两头大象的启示
标准制定的太早-》不成熟-》坏的标准
标准制定的太晚-》标准会被实际所忽视

### 糟糕的技术
模型和协议存在缺陷
会话层和表示层几乎是空的
数据链路层和网络层又包含太多内容
七层是出于政策的考量666
同时低效

### 糟糕的实现
最初实现庞大笨拙效率低
而TCP/IP是作为berkeley套接字的一部分出现的，运行的好，得到人们的欣赏

### 糟糕的政策
政府的强制标准反而令人反感

## TCP/IP的问题
- 并没有很好的区分服务 接口 协议的概念
- 不通用 不能用于其之外的任何协议栈
- 链路层只是一个接口而非通常意义上的一层
- 并未区分物理层和数据链路层
而且有些随时间演变无法更新的障碍
TELNET无法识别鼠标和用户界面










